<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><title
    >ICFP 2009 Programming Contest Diary</title
    ><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"
     /><meta name="generator" content="pandoc"
     /><meta name="author" content="Justin Bailey"
     /><meta name="date" content="June 25, 2009"
     /><link rel="stylesheet" href="style.css" type="text/css" media="all" />
</head
  ><body
  ><h1 class="title"
    >ICFP 2009 Programming Contest Diary</h1
    ><div id="wrapper">
<div id="masthead" class="fix" style="width: 100%">
<h1 class="sans"><a href="http://blog.codeslower.com" class="title">codeslower.com</a> <em>Savor Your Code.</em></h1>
</div>
<div id="mid" class="fix">
<div id="mainCol" class="fix">
<div id="article" class="post">

<div style="text-align: center"><h2 id="the-icfp-2009-programming-contest--a-diary"
    >The ICFP 2009 Programming Contest &#8212; A diary.</h2
    ><strong
    >Justin Bailey</strong
    > &lt;<tt>jgbailey@codeslower.com</tt>&gt;</div>

<div id="blogbody" class="entry">
<h3 id="june-25-2009----900-am"
    >June 25, 2009 -- 9:00 AM</h3
    ><p
    >This site will serve as a diary and reference for my work on the upcoming <a href="http://www.icfpcontest.org"
      >ICFP 2009 programming contest</a
      >. All code committed will be available on <a href="http://github.com/m4dc4p/func-n-stein/tree/master"
      >GitHub</a
      > and can be cloned from <tt>git://github.com/m4dc4p/func-n-stein.git</tt>.</p
    ><h3 id="june-25-2009----1143-am"
    >June 25, 2009 -- 11:43 AM</h3
    ><p
    >All times PDT, by the way.</p
    ><p
    >Downloaded the spec, read through it, seems a lot like last years problem. I have to implement a virtual machine and then solve a bunch of orbit problems? Sounds doubly tough. For starters I think I will implement something to write the <em
      >submission</em
      > format, and submit an empty solution. We'll see what happens.</p
    ><h3 id="june-25-2009----203-pm"
    >June 25, 2009 -- 2:03 PM</h3
    ><p
    >Got code to write a solution and have submitted an empty solution. Not sure if double representation will be written correctly - does Haskell write it in &quot;IEEE 764&quot; notation automatically? Had to do some pointer conversions to write doubles as binary data:</p
    ><pre
    ><code
      >          v &lt;- allocaBytes 8 $ \p -&gt; do 
                   poke p val 
                   mapM (\i -&gt; peekElemOff (castPtr p) i) [0, 1]
</code
      ></pre
    ><p
    >''val'' is our double value. I write to 8 byte memory location, then read out as two 32-bit values:</p
    ><pre
    ><code
      >          -- write to file
          hPutWord (int2Word addr)
          hPutWord (v !! 0)
          hPutWord (v !! 1)
</code
      ></pre
    ><p
    >''hPutWord'' fixes the type, as it takes a Word32 and writes it to a file:</p
    ><pre
    ><code
      > hPutWord :: Word32 -&gt; IO ()
 hPutWord w = with w $ \p -&gt; do
      hPutBuf h p (sizeOf w)
</code
      ></pre
    ><p
    >I do se a bug above, where I am not writing the value in little-endian order. Better fix that!</p
    ><h3 id="june-25-2009----252-pm"
    >June 25, 2009 -- 2:52 PM</h3
    ><p
    >Fairly confident output file format is being written correctly. At least the competition server doesn't complain When I submit solutions that write to the correct config port. Also cabalized early so it won't be too painful later -- I expect dependencies to grow.</p
    ></div>
</div>
</div>
</div>
</div>

</body
  ></html
>

